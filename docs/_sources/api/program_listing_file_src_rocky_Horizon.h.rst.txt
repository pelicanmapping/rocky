
.. _program_listing_file_src_rocky_Horizon.h:

Program Listing for File Horizon.h
==================================

|exhale_lsh| :ref:`Return to documentation for file <file_src_rocky_Horizon.h>` (``src/rocky/Horizon.h``)

.. |exhale_lsh| unicode:: U+021B0 .. UPWARDS ARROW WITH TIP LEFTWARDS

.. code-block:: cpp

   
   #pragma once
   
   #include <rocky/Common.h>
   #include <rocky/Ellipsoid.h>
   #include <rocky/Math.h>
   
   namespace ROCKY_NAMESPACE
   {
       class ROCKY_EXPORT Horizon
       {
       public:
           Horizon();
   
           Horizon(const Ellipsoid& ellipsoid);
   
           void setEllipsoid(const Ellipsoid& ellipsoid);
   
           bool setEye(const glm::dvec3& eyeECEF, bool isOrtho = false);
           const glm::dvec3& getEye() const { return _eye; }
   
           bool isVisible(double x, double y, double z, double radius = 0.0) const;
   
           template<typename T>
           bool isVisible(const T& vec3, double radius = 0.0) const {
               return isVisible(vec3.x, vec3.y, vec3.z, radius);
           }
   
           double getDistanceToVisibleHorizon() const;
   
           double getRadius() const;
   
           operator bool() const { return _valid; }
   
       protected:
           Ellipsoid _em;
           bool _valid = false;
           bool _orthographic = false; // assume orthographic projection
           glm::dvec3 _eye;       // world eyepoint
           glm::dvec3 _eyeUnit;   // unit eye vector (scaled)
           glm::dvec3 _VC;        // eye->center vector (scaled)
           double _VCmag = 0.0;    // distance from eye to center (scaled)
           double _VCmag2 = 0.0;   // distance from eye to center squared (scaled)
           double _VHmag2 = 0.0;   // distance from eye to horizon squared (scaled)
           double _coneCos = 0.0;  // cosine of half-cone
           double _coneTan = 0.0;  // tangent of half-cone
           glm::dvec3 _scale;     // transforms from world to unit space
           glm::dvec3 _scaleInv;  // transforms from unit to world space
           double _minHAE = 0.0;;   // minumum height above ellipsoid to test
           double _minVCmag = 0.0; // derived from minHAE
       };
   }
